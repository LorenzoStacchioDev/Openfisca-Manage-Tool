#:kivy 1.10.0
#: import utils kivy.utils

<ButtonReforms>
    background_color: hex('971640')
    font_size: "18sp"

<ReformsScreen>:
    name: "reforms"
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size
    GridLayout:
        rows: 2
        orientation: "vertical"
        BoxLayout:
            orientation: "vertical"
            BoxLayout:
                padding: (50,50,50,50)
                orientation: "horizontal"
                ButtonReforms:
                    id: button_add_variable
                    text: "Add variable"
                    on_release: root.go_to_add_variable()
                Label:
                    size_hint_x: None
                    width: self.parent.width*0.2
                ButtonReforms:
                    id: button_update_variable
                    text: "Update variable"
                    on_release: root.go_to_update_variable()
            BoxLayout:
                orientation: "horizontal"
                padding: (50,50,50,50)
                ButtonReforms:
                    id: button_neutralize_variable
                    text: "Neutralize variable"
                    on_release: root.go_to_neutralize_variable()
                Label:
                    size_hint_x: None
                    width: self.parent.width*0.2
                ButtonReforms:
                    id: button_add_parameter
                    text: "Add parameter"
                    on_release: root.to_do()
            BoxLayout:
                orientation: "horizontal"
                padding: (50,50,50,50)
                ButtonReforms:
                    id: button_modify_parameter
                    text: "Modify variable"
                    on_release: root.to_do()
                Label:
                    size_hint_x: None
                    width: self.parent.width*0.2
                ButtonReforms:
                    id: button_make_reform
                    text: "Make reform"
                    on_release: root.to_do()
        ButtonReforms:
            size_hint: (1.0,0.2)
            text: 'Come back to home'
            background_color: hex('971640')
            on_press: root.go_to_home()

<SelectVariableScreen>
    name: "select_variable_screen"
    BoxLayout:
        orientation: "vertical"
        Label:
        Label:
            text: "Type to filter"
        Label:
        TextInput:
            id: id_text_search_box
            size_hint: (0.8,None)
            pos_hint: {'center_x': .5, 'center_y': .5}
            multiline: False
            on_text_validate: root.change_spinner()
        Label:
        Spinner:
            id: id_spinner_select_variable_screen
            size_hint: (0.8,None)
            pos_hint: {'center_x': .5, 'center_y': .5}
        Label:
        GridLayout:
            cols: 2
            Label:
                id: id_label_reform_name
                text: "Reform name:"
            TextInput:
                id: id_input_reform_name
                text: ""
            Label:
                id: id_label_reform_description
                text: "Description:"
            TextInput:
                id: id_input_reform_description
                text: ""

        BoxLayout:
            orientation: "horizontal"
            Button:
                size_hint: (1.0,0.2)
                text: 'Select'
                background_color: hex('971640')
                on_press: root.select_variable()
            Button:
                size_hint: (1.0,0.2)
                text: 'Come back to home'
                background_color: hex('971640')
                on_press: root.go_to_home()

<FormVariableScreen>:
    name: "form_variable_screen"

    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Name"
                size_hint:(0.3,1)
            TextInput:
                id: name_input
                multiline: False
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Value type"
                size_hint:(0.3,1)
            Spinner:
                id: value_type_input
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Entity"
                size_hint:(0.3,1)
            Spinner:
                id: entity_input
                #multiline: False
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Set input period"
                size_hint:(0.3,1)
            Spinner:
                id: set_input_period
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Label"
                size_hint:(0.3,1)
            TextInput:
                id: label_input
                multiline: False
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Definition period"
                size_hint:(0.3,1)
            Spinner:
                id: definition_period_input
                #values: ["MONTH","YEAR","ETERNITY"]
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Reference"
                size_hint:(0.3,1)
            TextInput:
                id: reference_input
                multiline: False
                size_hint:(0.7,1)

        BoxLayout:
            padding: (30,30,30,0)
            orientation: "horizontal"
            Label:
                text: "Formula"
                size_hint:(0.3,1)
            Button:
                text: "Visualize formula"
                id: watch_formula
                on_press: root.create_pop_up_watch_formula()
                size_hint:(0.35,1)
            Button:
                text: "Modify formula"
                id: modify_formula
                on_press: root.create_pop_up_modify_formula()
                size_hint:(0.35,1)

        BoxLayout:
            padding: (0,30,0,0)
            orientation: "horizontal"
            Button:
                text: "Run operation"
                background_color: hex('971640')
                on_press: root.run_operation()
            Button:
                text: "Come back to home"
                on_press: root.go_to_home()
                background_color: hex('971640')


<WatchingFormulaPopUp>:
    size_hint: 0.8,0.8
    title: "Formula code"
    BoxLayout:
        orientation:'vertical'
        RstDocument:
            id: formula_view_from_update
        Button:
            text:"Close this popup"
            size_hint: 1,0.1
            on_press:root.dismiss()


<ModifyFormulaPopup>:
    size_hint: 0.8,0.8
    title: "Formula code"
    BoxLayout:
        orientation:'vertical'
        TextInput:
            id: txt_modify_formula
            multiline: True
            size_hint:(1,1)
        Button:
            text:"Click if you finish to modify the formula"
            size_hint: 1,0.1
            on_press:root.dismiss(), root.update_lines_basing_on(root.ids.txt_modify_formula.text)

<PopupSelectReform>:
    size_hint: 0.8,0.8
    title: "Select Reform"
    BoxLayout:
        orientation:'vertical'
        Label:
            text: "Select a reform"
        TextInput:
            id: id_text_search_box_reforms
            size_hint: (0.8,None)
            pos_hint: {'center_x': .5, 'center_y': .5}
            multiline: False
            on_text_validate: root.change_spinner()
        Label:
        Spinner:
            id: id_spinner_reforms
            size_hint: (0.8,None)
            pos_hint: {'center_x': .5, 'center_y': .5}
        Label:
        GridLayout:
            size_hint: 1,0.1
            cols: 2
            size_hint_y: None
            height: '44sp'
            Button:
                text: 'Select this reform'
                on_press: root.confirm()
            Button:
                text: 'Continue without reform'
                on_press: root.chiudi_popup()